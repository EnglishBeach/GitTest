Base code on old branch
fixed olfd code
